<div class="container mt-3">
  <h4><i class="bi bi-shield-lock-fill"></i> Impostazioni UniFi Protect Webhook</h4>
  <p>Gestisci la configurazione per il plugin webhook.</p>
  
  <div class="card">
    <div class="card-body">
      <h5 class="card-title">Configurazione Attuale</h5>
      <p class="card-text">Dati di configurazione caricati:</p>
      <pre id="config-display" style="max-height: 200px; overflow-y: auto;"></pre>
      
      <button class="btn btn-primary" id="save-button" disabled>Salva Modifiche</button>
    </div>
  </div>
</div>

<script>
(async () => {
  try {
    if (!window.homebridge) {
      console.error('API Homebridge non trovata!');
      return;
    }

    const config = await window.homebridge.getPluginConfig();
    const configDisplay = document.getElementById('config-display');
    
    if (config && config.length > 0) {
      configDisplay.textContent = JSON.stringify(config, null, 2);
    } else {
      configDisplay.textContent = 'Nessuna configurazione trovata.';
    }

    // const saveButton = document.getElementById('save-button');
    // saveButton.disabled = false;
    // saveButton.onclick = async () => {
    //   const newConfig = { ...config[0], nuovaChiave: 'valore' };
    //   await window.homebridge.updatePluginConfig([newConfig]);
    //   await window.homebridge.closeSettings();
    // };

  } catch (e) {
    console.error('Errore durante il caricamento della UI personalizzata:', e);
    document.getElementById('config-display').textContent = `Errore: ${e.message}`;
  }
})();
</script>
